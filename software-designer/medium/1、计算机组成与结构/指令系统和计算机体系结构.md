# 指令系统和计算机体系结构

## 概念
* CPU的控制器负责依次访问程序指令，进行指令译码，并协调其他设备，通常由程序计数器、指令寄存器、指令译码器、状态/条件寄存器、时序发生器、微操作信号发生器组成。CPU的控制器负责依次访问程序指令，进行指令译码，并协调其他设备，通常由程序计数器、指令寄存器、指令译码器、状态/条件寄存器、时序发生器、微操作信号发生器组成。

* 程序的局限性：表现在时间局部性和空间局部性： 1.时间局部性是指如果程序中的某条指令一旦被执行，则不久的将来该指令可能再次被执行； 2.空间局部性是指一旦程序访问了某个存储单元，则在不久的将来，其附近的存储单元也最有可能被访问。

* RISC(精简指令系统计算机)：指令和格式通常是固定的；寻址方式单一，多寄存器寻址；指令种类尽量少；采用硬布线控制逻辑优化编译程序
* CISC(复杂指令系统计算机)：指令系统复杂庞大，指令数目一般为200条以上。指令的长度不固定，指令格式多，寻址方式多。可以访存的指令不受限制。各种指令使用频度相差很大。各种指令执行时间相差很大，大多数指令需多个时钟周期才能完成。控制器大多数采用微程序控制

* 流水线方式执行指令：某一时刻可同时执行多条指令，避免各部件等待空闲，提高各部件利用率，也提高了系统的吞吐率，有以下特性：
1. 指令流水线的操作周期为各步骤耗时最长的步骤决定


*  VLIW:（Very Long Instruction Word，超长指令字）一种非常长的指令组合，它把许多条指令连在一起，增加了运算的速度。

* 移位指令：算术左移n位，相当于乘以2的n次方；算术右移n位，相当于除以2的n次方；

* 寻址方式：
1. 立即寻址是一种特殊的寻址方式，指令中在操作码字段后面的部分不是通常意义上的操作数地址，而是操作数本身，也就是说数据就包含在指令中，只要取出指令，也就取出了可以立即使用的操作数。 
2. 在直接寻址中，指令中地址码字段给出的地址A就是操作数的有效地址，即形式地址等于有效地址。 
3. 间接寻址意味着指令中给出的地址A不是操作数的地址，而是存放操作数地址的主存单元的地址，简称操作数地址的地址。 
4. 寄存器寻址指令的地址码部分给出了某一个通用寄存器的编号Ri，这个指定的寄存器中存放着操作数。

* Flynn主要根据指令流和数据流来分类，分为四 类： 
1. 单指令流单数据流机器（SISD） SISD机器是一种传统的串行计算机， 它的硬件 不支持任何形式的并行计算，所有的指令都是 串行执行，并且在某个时钟周期内，CPU只能 处理一个数据流。因此这种机器被称作单指令 流单数据流机器。早期的计算机都是SISD机 器。 
2. 单指令流多数据流机器（SIMD） SIMD是采用一个指令流处理多个数据流。这类 机器在数字信号处理、 图像处理以及多媒体信 息处理等领域非常有效。 Intel处理器实现的MMXTM、SSE （Streaming SIMD Extensions）、SSE2及SSE3扩展指令 集， 都能在单个时钟周期内处理多个数据单 元。也就是说人们现在用的单核计算机基本上 都属于SIMD机器。
3. 多指令流单数据流机器（MISD） MISD是采用多个指令流来处理单个数据流。在 实际情况中，采用多指令流处理多数据流才是 更有效的方法。因此MISD只是作为理论模型出 现， 没有投入实际应用。 
4. 多指令流多数据流机器 （MIMD） M1MD机器可以同时执行多个指令流，这些指令 流分别对不同数据流进行操作。例如，intel和 AMD的双核处理器就属于MIMD的范畴。

* 关于64位和32位的微处理器，有以下二倍的关系：
1. 通用寄存器的位数
2. 数据总线的宽度
3. 能同时进行运算的位数



## 计算题

1. 将一条指令的执行过程分解为取址、分析和执行三步，按照流水方式执行，若取址时间t取址=4△t、分析时间t分析=2△t、执行时间t执行=3△t，则执行完100条指令，需要的时间为**405**△t。

对于该指令流水线，建立时间为4△t+2△t+3△t=9△t，此后每4△t执行完一条指令， 即执行完100条指令的时间为9△t+99*4△t=405△t。

2. 某指令流水线由4段组成，各段所需要的时间如下图所示。连续输入8条指令时的吞吐率（单位时间内流水线所完成的任务数或输出的结果数）为（ ）。
流水线示例：
> ->△t->2△t->3△t->△t->

流水线的吞吐率指的是计算机中的流水线在特定的时间内可以处理的任务或输出数据的结果数量。流水线的吞吐率可以进一步分为最大吞吐率和实际吞吐率。该题目中要求解的是实际吞吐率，以流水方式执行8条指令的执行时间是7+(8-1)*3 = 28△t，因此吞吐率为8/28△t。

3.  若某计算机字长为32位，内存容量为2GB，按字编址，则可寻址范围为（ ）。

内存容量2GB=2*1024*1024*1024*8位，按字编址时，存储单元的个数为2*1024*1024*1024*8/32=512*1024*1024，即可寻址范围为512MB。

4. 若CPU要执行的指令为：MOV R 1，#45 （即将数值45传送到寄存器R 1中），则该指令中采用的寻址方式为（ ）。

指令中的寻址方式就是如何对指令中的地址字段进行解释，以获得操作数的方法或 获得程序转移地址的方法。常用的寻址方式有： 
* 立即寻址。操作数就包含在指令中。 
* 直接寻址。操作数存放在内存单元中，指令中直接给出操作数所在存储单元的地址。 
* 寄存器寻址。操作数存放在某一寄存器中，指令中给出存放操作数的寄存器名。 
* 寄存器间接寻址。操作数存放在内存单元中，操作数所在存储单元的地址在某个寄存器中。 
* 间接寻址。指令中给出操作数地址的地址。 •相对寻址。指令地址码给出的是一个偏移量（可正可负），操作数地址等于本条 指令的地址加上该偏移量。 
* 变址寻址。操作数地址等于变址寄存器的内容加偏移量。 

题目给出的指令中，R 1是寄存器，属于寄存器寻址方式，45是立即数，属于立即寻址方式。

